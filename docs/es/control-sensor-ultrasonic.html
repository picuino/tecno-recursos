<!DOCTYPE html>
<html class="no-js" lang="es" >
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="keywords" content="Tecnología, Educación Secundaria, Dibujo, Estructuras, Mecanismos, Materiales, Electricidad, Electrónica, Informática, Programación, Control, Arduino, Comunicaciones, Taller, Legislación Educativa">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Recursos educativos libres para Tecnología en Educación Secundaria. Robótica - Sensores - 1. Sensor de distancia por ultrasonidos">
  <title>1. Sensor de distancia por ultrasonidos - Sensores - Picuino</title>

  
  <link rel="icon" type="image/png" sizes="192x192" href="/favicon-192.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/favicon-96.png">
  <link rel="icon" type="image/png" sizes="48x48" href="/favicon-48.png">

  
  <link rel="canonical" href="https://www.picuino.com/es/control-sensor-ultrasonic.html">

  
  <link rel="search" type="application/opensearchdescription+xml"
        title="Search within ..."
        href="_static/opensearch.xml">

  <link rel="stylesheet" href="_static/theme.css" type="text/css">
  <link rel="stylesheet" href="_static/pygments.css" type="text/css">
  <link rel="stylesheet" href="_static/custom.css" type="text/css">
  <link rel="glossary" title="Glossary" href="genindex.html">
  <link rel="index" title="Índice" href="content.html">
  <link rel="search" title="Búsqueda" href="search.html">
  <link rel="next" title="2. Potenciómetro" href="control-sensor-potentiometer.html">
  <link rel="prev" title="Sensores" href="control-sensor-index.html">

</head>

<body class="wy-body-for-nav">

  <div class="wy-grid-for-nav">

    <div data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="content.html"><img src="_static/logo-picuino-bgblue.png" alt="O_[]¯O Picuino"></a>
      </nav>

	  <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="content.html">Home</a>/</li>
        
          <li><a href="robotica-index.html">Robótica</a>/</li>
        
          <li><a href="control-sensor-index.html">Sensores</a>/</li>
        
      <li><span class="section-number">1. </span>Sensor de distancia por ultrasonidos</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/control-sensor-ultrasonic.rst.txt" rel="nofollow"> Ver texto fuente</a>
          
        
      </li>
    
  </ul>

  

  
  <hr>

</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="sensor-de-distancia-por-ultrasonidos">
<h1><span class="section-number">1. </span>Sensor de distancia por ultrasonidos<a class="headerlink" href="#sensor-de-distancia-por-ultrasonidos" title="Enlazar permanentemente con este título">¶</a></h1>
<a class="reference internal image-reference" href="_images/img-0082.jpg"><img alt="Sensor de distancia por ultrasonidos SR04" class="align-center" src="_images/img-0082.jpg" style="width: 360px;"></a>
<div class="section" id="objetivos">
<h2>Objetivos<a class="headerlink" href="#objetivos" title="Enlazar permanentemente con este título">¶</a></h2>
<ul class="simple">
<li>Comprender el funcionamiento del sensor de distancia por
ultrasonidos.</li>
<li>Medir distancias con un sensor de distancia por ultrasonidos.</li>
</ul>
</div>
<div class="section" id="el-sensor-de-ultrasonidos">
<h2>El sensor de ultrasonidos<a class="headerlink" href="#el-sensor-de-ultrasonidos" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Este sensor tiene un pequeño altavoz que emite un pitido y un
micrófono sensor que detecta el pitido emitido.
El dispositivo calcula el tiempo que el sonido tarda en ir hasta un
objeto y volver reflejado.
La distancia desde el sensor hasta el objeto se calcula a partir de
la velocidad del sonido en el aire y del tiempo que tarda el sonido
en recorrer esa distancia.</p>
<p>El pitido emitido tiene una frecuencia de 40kHz. Esta frecuencia se
encuentra muy por encima de 20kHz, que es la máxima frecuencia que
los humanos pueden percibir. Por esta razón a este sonido de elevada
frecuencia se le denomina ultrasonido.</p>
<p>Existen varios modelos de sensor en el mercado, los más conocidos
y asequibles son el modelo SR04 y la versión más avanzada SRF05.
En este tutorial se explica el modelo SR04.
La explicación es válida para modelos más avanzados, teniendo en
cuenta que estos tienen mayor capacidad o características añadidas.</p>
</div>
<div class="section" id="caracteristicas-del-sensor-sr04">
<h2>Características del sensor SR04<a class="headerlink" href="#caracteristicas-del-sensor-sr04" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Este sensor de ultrasonidos tiene las siguientes características:</p>
<blockquote>
<div><ul class="simple">
<li>Distancia de detección: 2cm - 400cm</li>
<li>Resolución: 0,3cm</li>
<li>Frecuencia de sonido: 40kHz</li>
<li>Ángulo eficaz: 15º</li>
<li>Tensión de alimentación: 5V</li>
<li>Consumo de corriente: 15mA</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="libreria-para-sensores-de-ultrasonidos">
<h2>Librería para sensores de ultrasonidos<a class="headerlink" href="#libreria-para-sensores-de-ultrasonidos" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Para manejar los sensores de ultrasonidos existen varias librerías de
trabajo.
La librería estándar más precisa que se puede utilizar es
<a class="reference external" href="https://playground.arduino.cc/Code/NewPing" rel="noopener noreferrer" target="_blank">NewPing</a>.
Para instalar la librería hay que seguir los siguientes pasos:</p>
<ol class="arabic simple">
<li>Descargar la librería</li>
<li>Guardar el fichero NewPing_v1.9.4.zip en el ordenador</li>
<li>Abrir el entorno gráfico de Arduino</li>
<li>En la pestaña Sketch.. Importar librería.. pinchar 'Add Library...'</li>
<li>Buscar el fichero descargado y después de seleccionarle,
pulsar 'Abrir'</li>
<li>Comprobar que en la pestaña Sketch.. Importar librería..
aparece una nueva librería llamada NewPing</li>
</ol>
<p>Con estos pasos la librería estará correctamente instalada.</p>
</div>
<div class="section" id="medicion-de-distancias">
<h2>Medición de distancias<a class="headerlink" href="#medicion-de-distancias" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Para medir distancias con el sensor SR04 se seguirán los
siguientes pasos:</p>
<ol class="arabic">
<li><p class="first">Conectar el sensor SR04 a la placa Arduino según el siguiente
esquema:</p>
<a class="reference internal image-reference" href="_images/img-0009.png"><img alt="Conexión Arduino-SR04" class="align-center" src="_images/img-0009.png" style="width: 600px;"></a>
</li>
<li><p class="first">Copiar el siguiente programa, compilarlo y descargarlo en la placa
Arduino.</p>
<div class="highlight-Arduino notranslate" id="ultrasonic-prog1"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Medición de distancias por ultrasonidos.</span>
<span class="c1">// Método basado en la velocidad del sonido.</span>

<span class="cp">#include</span> <span class="cpf">&lt;NewPing.h&gt;</span><span class="cp"></span>

<span class="cp">#define TRIGGER_PIN    4     </span><span class="c1">// Pin de Arduino conectado a la patilla Trigger, en el sensor de ultrasonidos.</span>
<span class="cp">#define ECHO_PIN       2     </span><span class="c1">// Pin de Arduino conectado a la patilla Echo, en el sensor de ultrasonidos.</span>
<span class="cp">#define MAX_DISTANCE 200     </span><span class="c1">// Distancia máxima que podrá medir el sensor.</span>
                             <span class="c1">// Esta distancia puede llegar a valer 400cm</span>
<span class="cp">#define SOUND_SPEED 0.171    </span><span class="c1">// La mitad de la velocidad del sonido en el aire, medida en [mm/us]</span>

<span class="n">NewPing</span> <span class="nf">sonar</span><span class="p">(</span><span class="n">TRIGGER_PIN</span><span class="p">,</span> <span class="n">ECHO_PIN</span><span class="p">,</span> <span class="n">MAX_DISTANCE</span><span class="p">);</span> <span class="c1">// Configuración de la librería NewPing</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
   <span class="nf">Serial</span><span class="p">.</span><span class="nf">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>     <span class="c1">// Abre las comunicaciones serie entre Arduino y el ordenador</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
   <span class="kr">int</span> <span class="n">microseconds</span><span class="p">;</span>                <span class="c1">// Tiempo que tarda el sonido del sensor en rebotar y volver</span>
   <span class="kr">int</span> <span class="n">distance</span><span class="p">;</span>                    <span class="c1">// Distancia al obstáculo en centímetros</span>

   <span class="nf">delay</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>                       <span class="c1">// Espera 50 milisegundos entre dos ping consecutivos.</span>
                                    <span class="c1">// Este tiempo evita errores producidos por el eco.</span>
   <span class="n">microseconds</span> <span class="o">=</span> <span class="n">sonar</span><span class="p">.</span><span class="n">ping</span><span class="p">();</span>     <span class="c1">// Mide el tiempo que tarda el sonido en rebotar</span>
   <span class="n">distance</span> <span class="o">=</span> <span class="n">microseconds</span> <span class="o">*</span> <span class="n">SOUND_SPEED</span><span class="p">;</span> <span class="c1">// Calcula la distancia al objeto en milímetros</span>

   <span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;Ping: &quot;</span><span class="p">);</span>          <span class="c1">// Envía al ordenador un mensaje con la distancia medida</span>
   <span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">microseconds</span><span class="p">);</span>
   <span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;us</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">);</span>
   <span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">distance</span><span class="p">);</span>
   <span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="s">&quot;mm&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</li>
<li><p class="first">Abrir el monitor serie (Monitor Serial) pulsando el icono que
aparece arriba a la derecha en el entorno gráfico de Arduino.</p>
<img alt="Botón del monitor serie" class="align-center" src="_images/img-0010.png">
</li>
<li><p class="first">En la nueva ventana que aparece, escoger la velocidad de
transmisión en el recuadro que aparece abajo a la derecha.
En este caso, la velocidad programada es de 115200 baudios.</p>
<p>El cuadro debe mostrar continuamente la información de tiempo y
distancia.</p>
<img alt="Monitor serie" class="align-center" src="_images/img-0012.png">
</li>
</ol>
<p>En este momento, si todo ha ido bien, Arduino estará midiendo
continuamente la distancia entre el sensor y los objetos que se
coloquen delante de él. Esta distancia se envía al ordenador mediante
el puerto serie (por el cable USB) para visualizarlo en pantalla.</p>
</div>
<div class="section" id="ajuste-del-sensor">
<h2>Ajuste del sensor<a class="headerlink" href="#ajuste-del-sensor" title="Enlazar permanentemente con este título">¶</a></h2>
<p>El ajuste del sensor permite que las mediciones sean más exactas.
Para conseguir ajustar el sensor es necesario corregir múltiples
parámetros que pueden influir en la medida. La velocidad del sonido
en el aire, la presión atmosférica, la velocidad del cronómetro
interno del sensor, etc. Para evitar la complejidad de ajustar uno
por uno todos estos parámetros, se va a realizar un ajuste
denominado ajuste de dos puntos.</p>
<p>Primero se debe realizar una medida a una distancia conocida, cercana
al sensor. Después se debe realizar otra medición a una distancia
conocida, más lejana al sensor.</p>
<p>La primera medición puede corregir lo que se denomina ajuste de cero.
La segunda medida sirve para realizar el ajuste de rampa.
Las medidas se deben introducir en una tabla como la siguiente:</p>
<blockquote>
<div><table class="docutils align-default" id="id1">
<caption><span class="caption-text">Tabla 1.</span><a class="headerlink" href="#id1" title="Enlace permanente a esta tabla">¶</a></caption>
<colgroup>
<col style="width:33%;">
<col style="width:33%;">
<col style="width:33%;">
</colgroup>
<thead style="vertical-align:bottom;">
<tr class="row-odd"><th class="head">Medida</th>
<th class="head">Tiempo</th>
<th class="head">Distancia</th>
</tr>
</thead>
<tbody style="vertical-align:top;">
<tr class="row-even"><td>Medida 1</td>
<td>247us</td>
<td>50mm</td>
</tr>
<tr class="row-odd"><td>Medida 2</td>
<td>1123 us</td>
<td>200mm</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>A partir de esta tabla, se puede realizar un mejor ajuste de la
medida con la orden
<a class="reference external" href="https://www.arduino.cc/reference/en/language/functions/math/map/" rel="noopener noreferrer" target="_blank">map()</a>
de Arduino:</p>
<blockquote>
<div>distance = map(microseconds, 247, 1123, 50, 200);</div></blockquote>
<p>El primer argumento es la medición de tiempo realizada por el sensor.
Los dos siguientes argumentos son los tiempos de rebote al objeto
cercano y lejano.
Los dos siguientes argumentos son las distancias del objeto cercano
y lejano.</p>
<p>El programa modificado es el siguiente.</p>
<div class="highlight-Arduino notranslate" id="ultrasonic-prog2"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Medición de distancias por ultrasonidos.</span>
<span class="c1">// Método basado en el ajuste de dos puntos.</span>

<span class="cp">#include</span> <span class="cpf">&lt;NewPing.h&gt;</span><span class="cp"></span>

<span class="cp">#define TRIGGER_PIN    4   </span><span class="c1">// Pin de Arduino conectado a la patilla Trigger, en el sensor de ultrasonidos.</span>
<span class="cp">#define ECHO_PIN       2   </span><span class="c1">// Pin de Arduino conectado a la patilla Echo, en el sensor de ultrasonidos.</span>
<span class="cp">#define MAX_DISTANCE 200   </span><span class="c1">// Distancia máxima que podrá medir el sensor.</span>
                           <span class="c1">// Esta distancia puede llegar a valer 400cm</span>

<span class="kr">const</span> <span class="kr">int</span> <span class="n">time1</span> <span class="o">=</span> <span class="mi">247</span><span class="p">;</span>     <span class="c1">// Tiempo, en microsegundos, del ping al objeto cercano</span>
<span class="kr">const</span> <span class="kr">int</span> <span class="n">distance1</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span>  <span class="c1">// Distancia, en milímetros, al objeto cercano</span>
<span class="kr">const</span> <span class="kr">int</span> <span class="n">time2</span> <span class="o">=</span> <span class="mi">1123</span><span class="p">;</span>    <span class="c1">// Tiempo, en microsegundos, del ping al objeto lejano</span>
<span class="kr">const</span> <span class="kr">int</span> <span class="n">distance2</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span> <span class="c1">// Distancia, en milímetros, al objeto lejano</span>

<span class="n">NewPing</span> <span class="nf">sonar</span><span class="p">(</span><span class="n">TRIGGER_PIN</span><span class="p">,</span> <span class="n">ECHO_PIN</span><span class="p">,</span> <span class="n">MAX_DISTANCE</span><span class="p">);</span> <span class="c1">// Configuración de la librería NewPing</span>

<span class="kr">int</span> <span class="n">microseconds</span><span class="p">;</span>             <span class="c1">// Tiempo que tarda el sonido del sensor en rebotar y volver</span>
<span class="kr">int</span> <span class="n">distance</span><span class="p">;</span>                 <span class="c1">// Distancia al obstáculo en centímetros</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
   <span class="nf">Serial</span><span class="p">.</span><span class="nf">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>   <span class="c1">// Abre las comunicaciones serie entre Arduino y el ordenador</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
   <span class="nf">delay</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>                    <span class="c1">// Espera 50 milisegundos entre dos ping consecutivos.</span>
                                 <span class="c1">// Este tiempo evita errores producidos por el eco.</span>
   <span class="n">microseconds</span> <span class="o">=</span> <span class="n">sonar</span><span class="p">.</span><span class="n">ping</span><span class="p">();</span>  <span class="c1">// Mide el tiempo que tarda el sonido en rebotar</span>

   <span class="c1">// Calcula con precisión la distancia al objeto en milímetros</span>
   <span class="n">distance</span> <span class="o">=</span> <span class="nf">map</span><span class="p">(</span><span class="n">microseconds</span><span class="p">,</span> <span class="n">time1</span><span class="p">,</span> <span class="n">time2</span><span class="p">,</span> <span class="n">distance1</span><span class="p">,</span> <span class="n">distance2</span><span class="p">);</span>

   <span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;Ping: &quot;</span><span class="p">);</span>       <span class="c1">// Envía al ordenador un mensaje con la distancia medida</span>
   <span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">microseconds</span><span class="p">);</span>
   <span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;us</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">);</span>
   <span class="nf">Serial</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="n">distance</span><span class="p">);</span>
   <span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="s">&quot;mm&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="ejercicios">
<h2>Ejercicios<a class="headerlink" href="#ejercicios" title="Enlazar permanentemente con este título">¶</a></h2>
<ol class="arabic">
<li><p class="first">Realizar las mediciones para ajuste de dos puntos con un sensor
concreto.
Modificar el <a class="reference internal" href="uno-doc/ultrasonic.html#ultrasonic-prog2"><span class="std std-ref">programa anterior</span></a> para
conseguir que el sensor devuelva medidas exactas con mediciones
propias.</p>
<p>Cada sensor dará unos valores diferentes para los 4 números
de la tabla 1, dependiendo de la altitud a la que nos
encontremos, la temperatura y otros parámetros del sensor.</p>
</li>
<li><p class="first">Mostrar la distancia medida en el display de 7 segmentos con el
siguiente programa.</p>
<div class="highlight-Arduino notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Medición de distancias por ultrasonidos.</span>
<span class="c1">// Mostrar el valor de distancia en display de 7 segmentos.</span>

<span class="cp">#include</span> <span class="cpf">&lt;Wire.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;PC42.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;NewPing.h&gt;</span><span class="cp"></span>

<span class="cp">#define TRIGGER_PIN    4  </span><span class="c1">// Pin de Arduino conectado a la patilla Trigger, en el sensor de ultrasonidos.</span>
<span class="cp">#define ECHO_PIN       2  </span><span class="c1">// Pin de Arduino conectado a la patilla Echo, en el sensor de ultrasonidos.</span>
<span class="cp">#define MAX_DISTANCE 200  </span><span class="c1">// Distancia máxima que podrá medir el sensor.</span>
                          <span class="c1">// Esta distancia puede llegar a valer 400cm</span>
<span class="cp">#define SOUND_SPEED 0.171    </span><span class="c1">// La mitad de la velocidad del sonido en el aire, medida en [mm/us]</span>

<span class="n">NewPing</span> <span class="nf">sonar</span><span class="p">(</span><span class="n">TRIGGER_PIN</span><span class="p">,</span> <span class="n">ECHO_PIN</span><span class="p">,</span> <span class="n">MAX_DISTANCE</span><span class="p">);</span> <span class="c1">// Configuración de la librería NewPing</span>

<span class="kr">int</span> <span class="n">distance</span><span class="p">,</span> <span class="n">microseconds</span><span class="p">;</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
   <span class="n">pc</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>            <span class="c1">// Inicializar el módulo PC42</span>
<span class="p">};</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
   <span class="nf">delay</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>             <span class="c1">// Esperar 50 milisegundos entre dos ping consecutivos.</span>
                          <span class="c1">// Este tiempo evita errores producidos por el eco.</span>

   <span class="n">microseconds</span> <span class="o">=</span> <span class="n">sonar</span><span class="p">.</span><span class="n">ping</span><span class="p">();</span> <span class="c1">// Medir el tiempo que tarda el sonido en rebotar</span>

   <span class="n">distance</span> <span class="o">=</span> <span class="n">microseconds</span> <span class="o">*</span> <span class="n">SOUND_SPEED</span><span class="p">;</span> <span class="c1">// Calcular la distancia al objeto en milímetros</span>

   <span class="n">pc</span><span class="p">.</span><span class="n">dispWrite</span><span class="p">(</span><span class="n">distance</span><span class="p">);</span>      <span class="c1">// Mostrar la distancia en el display de 7 segmentos</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</li>
<li><p class="first">Encender una barra de ledes que represente la distancia de un objeto
al sensor de ultrasonidos.
Completar el programa para que la barra ocupe 6 ledes.</p>
<div class="highlight-Arduino notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Medición de distancias por ultrasonidos.</span>
<span class="c1">// Mostrar el valor de distancia en display de 7 segmentos.</span>

<span class="cp">#include</span> <span class="cpf">&lt;Wire.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;PC42.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;NewPing.h&gt;</span><span class="cp"></span>

<span class="cp">#define TRIGGER_PIN    4   </span><span class="c1">// Pin de Arduino conectado a la patilla Trigger, en el sensor de ultrasonidos.</span>
<span class="cp">#define ECHO_PIN       2   </span><span class="c1">// Pin de Arduino conectado a la patilla Echo, en el sensor de ultrasonidos.</span>
<span class="cp">#define MAX_DISTANCE 200   </span><span class="c1">// Distancia máxima que podrá medir el sensor.</span>
                           <span class="c1">// Esta distancia puede llegar a valer 400cm</span>
<span class="cp">#define SOUND_SPEED 0.171  </span><span class="c1">// La mitad de la velocidad del sonido en el aire, medida en [mm/us]</span>

<span class="n">NewPing</span> <span class="nf">sonar</span><span class="p">(</span><span class="n">TRIGGER_PIN</span><span class="p">,</span> <span class="n">ECHO_PIN</span><span class="p">,</span> <span class="n">MAX_DISTANCE</span><span class="p">);</span> <span class="c1">// Configuración de la librería NewPing</span>

<span class="kr">int</span> <span class="n">microseconds</span><span class="p">;</span>         <span class="c1">// Tiempo que tarda el sonido del sensor en rebotar y volver</span>
<span class="kr">int</span> <span class="n">distance</span><span class="p">;</span>             <span class="c1">// Distancia al obstaculo en centímetros</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
   <span class="n">pc</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>            <span class="c1">// Inicializar el módulo PC42</span>
<span class="p">};</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
   <span class="nf">delay</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>             <span class="c1">// Esperar 50 milisegundos entre dos ping consecutivos.</span>
                          <span class="c1">// Este tiempo evita errores producidos por el eco.</span>

   <span class="n">microseconds</span> <span class="o">=</span> <span class="n">sonar</span><span class="p">.</span><span class="n">ping</span><span class="p">();</span>           <span class="c1">// Medir el tiempo que tarda el sonido en rebotar</span>

   <span class="n">distance</span> <span class="o">=</span> <span class="n">microseconds</span> <span class="o">*</span> <span class="n">SOUND_SPEED</span><span class="p">;</span> <span class="c1">// Calcular la distancia al objeto en milímetros</span>

   <span class="c1">// Encender el led 1 si la distancia es mayor de 40mm</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">distance</span> <span class="o">&gt;</span> <span class="mi">40</span><span class="p">)</span>
      <span class="n">pc</span><span class="p">.</span><span class="n">ledWrite</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">LED_ON</span><span class="p">);</span>
   <span class="k">else</span>
      <span class="n">pc</span><span class="p">.</span><span class="n">ledWrite</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">LED_OFF</span><span class="p">);</span>

   <span class="c1">// Encender el led 2 si la distancia es mayor de 80mm</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">distance</span> <span class="o">&gt;</span> <span class="mi">80</span><span class="p">)</span>
      <span class="n">pc</span><span class="p">.</span><span class="n">ledWrite</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">LED_ON</span><span class="p">);</span>
   <span class="k">else</span>
      <span class="n">pc</span><span class="p">.</span><span class="n">ledWrite</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">LED_OFF</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</li>
</ol>
</div>
</div>


           </div>
           
          </div>
          <footer>

  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="control-sensor-potentiometer.html" class="btn btn-neutral float-right" title="2. Potenciómetro" accesskey="n" rel="next">Siguiente <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="control-sensor-index.html" class="btn btn-neutral" title="Sensores" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Anterior</a>
      
    </div>
  

  <hr>

  <div role="contentinfo">
    <ul class="link-list">
    <li><a href="contacto.html" target="_blank">Contacto</a></li>
    <li><a href="manifiesto.html" target="_blank">Manifiesto</a></li>
    <li><a href="../es/legal-aviso.html" target="_blank">Aviso legal</a></li>
    <li><a href="legal-cookies.html" target="_blank">Política de Cookies</a></li>
    <li><a href="legal-attribution.html" target="_blank">Créditos</a></li>
    <li><a href="genindex.html" target="_blank">Glosario</a></li>
    <li><a href="content.html" target="_blank">Índice</a></li>
    </ul>
    <p class="content-info">
      Copyright &copy; 2013-2025, Carlos Félix Pardo Martín.
      <br>

      Contenidos bajo <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.es" target="_blank">licencia CC BY-SA 4.0</a>
      y programas de ordenador bajo <a href="https://www.gnu.org/licenses/gpl-3.0.html" target="_blank">licencia GPL v3</a>
      a menos que se indique lo contrario.
      <br>
      <span class="lastupdated">
        Actualizado por última vez en enero, 2025.
      </span>

    </p>
  </div> 

</footer>


          

        </div>
      </div>

    </div>


    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html">
          

          
            
            <img src="_static/logo-picuino-bgblue.png" class="logo" alt="O_[]¯O Picuino">
          
          </a>
          <br>
          <a href="../en/control-sensor-ultrasonic.html">English</a>
          <br>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Buscar docs">
    <input type="hidden" name="check_keywords" value="yes">
    <input type="hidden" name="area" value="default">
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="dibujo-index.html">Dibujo Técnico</a></li>
<li class="toctree-l1"><a class="reference internal" href="mecan-index.html">Mecánica</a></li>
<li class="toctree-l1"><a class="reference internal" href="material-index.html">Materiales</a></li>
<li class="toctree-l1"><a class="reference internal" href="electric-index.html">Electricidad</a></li>
<li class="toctree-l1"><a class="reference internal" href="electronic-index.html">Electrónica</a></li>
<li class="toctree-l1"><a class="reference internal" href="informatica-index.html">Informática</a></li>
<li class="toctree-l1"><a class="reference internal" href="prog-index.html">Programación</a></li>
<li class="toctree-l1"><a class="reference internal" href="arduprog/index.html">Arduino</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="robotica-index.html">Robótica</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="control-index.html">Control de sistemas</a></li>
<li class="toctree-l2"><a class="reference internal" href="control-actuator-index.html">Actuadores</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="control-sensor-index.html">Sensores</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">1. Sensor de distancia por ultrasonidos</a></li>
<li class="toctree-l3"><a class="reference internal" href="control-sensor-potentiometer.html">2. Potenciómetro</a></li>
<li class="toctree-l3"><a class="reference internal" href="control-sensor-temp.html">3. Sensor de temperatura</a></li>
<li class="toctree-l3"><a class="reference internal" href="control-sensor-dht11.html">4. Sensor de temperatura y humedad DHT11</a></li>
<li class="toctree-l3"><a class="reference internal" href="control-sensor-light.html">5. Sensores de luz</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="robotica-normativa.html">Normativa Código Escuela 4.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="robotica-recursos.html">Recursos para Robótica</a></li>
<li class="toctree-l2"><a class="reference internal" href="robotica-robots-actuales.html">Robots actuales</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="comm-index.html">Comunicaciones</a></li>
<li class="toctree-l1"><a class="reference internal" href="taller-index.html">Taller de Tecnología</a></li>
<li class="toctree-l1"><a class="reference internal" href="recursos-index.html">Otros recursos</a></li>
<li class="toctree-l1"><a class="reference internal" href="ley-index.html">Legislación Educativa</a></li>
</ul>

            
          

          <!-- Enlaces directos -->
          <br>
          <ul>
          <li class="toctree-l1"><a class="reference internal"
          href="https://www.picuino.com/es/manifiesto.html">Manifiesto</a>
          </li><li class="toctree-l1"><a class="reference internal"
          href="https://www.picuino.com/test/">Test de Tecnología</a>
          </li><li class="toctree-l1"><a class="reference internal"
          href="https://www.picuino.com/circuits/">Simulador de circuitos</a>
          </li><li class="toctree-l1"><a class="reference internal"
          href="https://github.com/picuino/tecno-recursos">Proyecto en GitHub</a>
          </li>
          </ul>
        </div>
      </div>
    </nav>

  </div>
  


  

    
    
      <script defer id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script src="_static/translations.js"></script>
    

   

  <script defer src="_static/theme.js"></script>

  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

</body>
</html>