# HELP
#   object: dependencies
#   $@ object
#   $^ dependencies
#   $< first element of dependencies list

IMGDIR=_images
SOURCES=_sources

LIBS=$(wildcard _symbol_lib/*) $(wildcard Licen*)

JOINPDF=gswin32.exe -dBATCH -dNOPAUSE -q -sDEVICE=pdfwrite
PDFTOPNG=pdftopng -gray -r 600 -aa yes -aaVector yes -freetype yes
OPTIPNG=optipng -quiet -o 5
CONVERT=convert
CONVERT_OPT=-transparent White
MOGRIFY=mogrify
ZIP=7z a
PYTHON=python

# --------------------------------------------------------------------
# electric-cableado
#

$(IMGDIR)/electric-cableado-1.png: electric-cableado.pdf
	$(PDFTOPNG) $< $(basename $<)
	mv $(basename $<)-000001.png  $(IMGDIR)/$(basename $<)-1.png
	mv $(basename $<)-000002.png  $(IMGDIR)/$(basename $<)-2.png
	mv $(basename $<)-000003.png  $(IMGDIR)/$(basename $<)-3.png
	$(MOGRIFY) -posterize 16 $(IMGDIR)/$(basename $<)-1.png
	$(MOGRIFY) -posterize 16 $(IMGDIR)/$(basename $<)-2.png
	$(MOGRIFY) -posterize 16 $(IMGDIR)/$(basename $<)-3.png
	$(OPTIPNG) $(IMGDIR)/$(basename $<)-1.png
	$(OPTIPNG) $(IMGDIR)/$(basename $<)-2.png
	$(OPTIPNG) $(IMGDIR)/$(basename $<)-3.png

$(IMGDIR)/electric-cableado-circuitos.png: electric-cableado-circuitos.pdf
	$(PDFTOPNG) $< $(basename $<)
	mv $(basename $<)-000001.png  $(IMGDIR)/$(basename $<).png
	$(MOGRIFY) -posterize 16 $(IMGDIR)/$(basename $<).png
	$(OPTIPNG) $(IMGDIR)/$(basename $<).png

electric-cableado.zip: $(LIBS) $(wildcard electric-cableado/*)
	rm -f $@ electric-cableado/*.bak
	$(ZIP) $@ $^


.PHONY: all-cableado  clean-cableado
all-cableado: \
	electric-cableado.zip \
	$(IMGDIR)/electric-cableado-circuitos.png \
	$(IMGDIR)/electric-cableado-1.png \

clean-cableado:
	rm -f electric-cableado.zip
	rm -f $(IMGDIR)/electric-cableado-circuitos.png
	rm -f $(IMGDIR)/electric-cableado-1.png
	rm -f $(IMGDIR)/electric-cableado-2.png
	rm -f $(IMGDIR)/electric-cableado-3.png


# --------------------------------------------------------------------
# make all
#
.PHONY: all clean
all: \
	all-cableado \


clean: \
	clean-cableado \
